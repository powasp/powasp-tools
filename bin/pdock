#!/bin/bash

# Docker command shortcuts
# Usage: pdock [-f] <command>


# Variables
FORCE=""


# Check for -f flag (Sets $FORCE to the "-f" if the flag is present, or "?" if not)
getopts f FORCE

# Shifts the option index to after the flags
shift $(($OPTIND-1))

# See what command to run
case "$1" in
	rmi)
		# Check if there are no images to remove
		if [[ -z "$(docker images -aq)" ]]; then
			echo "No images to remove"
			exit
		fi

		echo "Removing all images"

		# Confirm before running
		pconfirm -n && docker rmi $(docker images -aq)
		;;
	rmc)
		echo "Removing all containers"

		# Check if force -f
		if $(pflag "$FORCE"); then
			pconfirm -n "Stop running containers?" && docker stop $(docker ps -aq)
		fi

		# Check if there are no containers to remove
		if [[ -z "$(docker ps -aq)" ]]; then
			echo "No containers to remove"
			exit
		fi

		# Confirm before running
		pconfirm -n "Delete all containers?" && docker rm $(docker ps -aq)
		;;
	*)
		echo "Error: command not found"
		;;
esac
